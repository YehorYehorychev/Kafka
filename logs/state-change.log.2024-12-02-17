[2024-12-02 18:00:32,821] INFO [Controller id=0 epoch=1] Changed partition months-5 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=1) (state.change.logger)
[2024-12-02 18:00:32,822] INFO [Controller id=0 epoch=1] Changed partition months-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=1) (state.change.logger)
[2024-12-02 18:00:32,822] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2024-12-02 18:00:32,822] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2024-12-02 18:00:32,822] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2024-12-02 18:00:32,822] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 2 partitions (state.change.logger)
[2024-12-02 18:00:32,823] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 7 from controller 0 for 2 partitions (state.change.logger)
[2024-12-02 18:00:32,823] INFO [Broker id=0] Follower months-5 starts at leader epoch 1 from offset 9 with partition epoch 1 and high watermark 9. Current leader is 2. Previous leader Some(2) and previous leader epoch was 1. (state.change.logger)
[2024-12-02 18:00:32,823] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2024-12-02 18:00:32,823] INFO [Broker id=0] Follower months-2 starts at leader epoch 1 from offset 0 with partition epoch 1 and high watermark 0. Current leader is 1. Previous leader Some(1) and previous leader epoch was 1. (state.change.logger)
[2024-12-02 18:00:32,823] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 1 with correlation id 7 for 2 partitions (state.change.logger)
[2024-12-02 18:00:32,824] INFO [Controller id=0 epoch=1] Sending StopReplica request for 5 replicas to broker 0 (state.change.logger)
[2024-12-02 18:00:32,825] INFO [Broker id=0] Finished LeaderAndIsr request in 2ms correlationId 7 from controller 0 for 2 partitions (state.change.logger)
[2024-12-02 18:00:32,829] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 8 (state.change.logger)
[2024-12-02 18:00:32,835] INFO [Broker id=0] Handling StopReplica request correlationId 9 from controller 0 for 5 partitions (state.change.logger)
[2024-12-02 18:00:32,843] INFO [Controller id=0 epoch=1] Partition months-4 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-12-02 18:00:32,843] INFO [Controller id=0 epoch=1] Partition months-0 state changed to (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-12-02 18:00:32,843] INFO [Controller id=0 epoch=1] Partition months-1 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-12-02 18:00:32,844] INFO [Controller id=0 epoch=1] Partition months-6 state changed to (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-12-02 18:00:32,844] INFO [Controller id=0 epoch=1] Partition months-3 state changed to (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-12-02 18:00:32,845] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 2 with 3 become-leader and 2 become-follower partitions (state.change.logger)
[2024-12-02 18:00:32,845] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 1 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2024-12-02 18:00:32,845] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 5 partitions (state.change.logger)
[2024-12-02 18:00:32,845] INFO [Controller id=0 epoch=1] Sending StopReplica request for 5 replicas to broker 0 (state.change.logger)
[2024-12-02 18:00:32,846] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 10 (state.change.logger)
[2024-12-02 18:00:32,846] INFO [Broker id=0] Handling StopReplica request correlationId 11 from controller 0 for 5 partitions (state.change.logger)
[2024-12-02 18:00:32,865] INFO [Controller id=0 epoch=1] Changed partition months-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2024-12-02 18:00:32,865] INFO [Controller id=0 epoch=1] Changed partition months-4 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2024-12-02 18:00:32,869] INFO [Controller id=0 epoch=1] Changed partition months-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2024-12-02 18:00:32,869] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 2 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-12-02 18:00:32,869] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-12-02 18:00:32,869] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-12-02 18:00:32,869] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 3 partitions (state.change.logger)
[2024-12-02 18:00:32,869] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2024-12-02 18:00:32,872] INFO [Controller id=0 epoch=1] Sending StopReplica request for 4 replicas to broker 1 (state.change.logger)
[2024-12-02 18:00:32,894] INFO [Controller id=0 epoch=1] Partition months-3 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-12-02 18:00:32,894] INFO [Controller id=0 epoch=1] Partition months-0 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-12-02 18:00:32,894] INFO [Controller id=0 epoch=1] Partition months-5 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-12-02 18:00:32,894] INFO [Controller id=0 epoch=1] Partition months-6 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-12-02 18:00:32,894] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 2 with 4 become-leader and 0 become-follower partitions (state.change.logger)
[2024-12-02 18:00:32,894] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2024-12-02 18:00:32,897] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set(0, 1, 2) for 4 partitions (state.change.logger)
[2024-12-02 18:00:32,897] INFO [Controller id=0 epoch=1] Sending StopReplica request for 4 replicas to broker 1 (state.change.logger)
[2024-12-02 18:00:32,900] ERROR [Controller id=0 epoch=1] Controller 0 epoch 1 failed to change state for partition months-4 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition months-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2024-12-02 18:00:32,901] ERROR [Controller id=0 epoch=1] Controller 0 epoch 1 failed to change state for partition months-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition months-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2024-12-02 18:00:32,901] ERROR [Controller id=0 epoch=1] Controller 0 epoch 1 failed to change state for partition months-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition months-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2024-12-02 18:00:32,902] ERROR [Controller id=0 epoch=1] Controller 0 epoch 1 failed to change state for partition months-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition months-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2024-12-02 18:00:32,902] ERROR [Controller id=0 epoch=1] Controller 0 epoch 1 failed to change state for partition months-6 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition months-6 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2024-12-02 18:00:32,902] ERROR [Controller id=0 epoch=1] Controller 0 epoch 1 failed to change state for partition months-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition months-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2024-12-02 18:00:32,902] ERROR [Controller id=0 epoch=1] Controller 0 epoch 1 failed to change state for partition months-3 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition months-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136)
[2024-12-02 18:00:32,902] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2024-12-02 18:00:32,902] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
